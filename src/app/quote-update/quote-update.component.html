<div id="main-quote">
<div class="p-buttonset menubar">
  <button pButton class="p-button-sm" type="button" label="Enregistrer" icon="pi pi-save" style="margin-bottom:5px; margin-right:5px" (click)="onSave()" *ngIf="document.status != 'LOCK'"></button>
  <button pButton class="p-button-sm" type="button" label="Valider" icon="pi pi-check" style="margin-bottom:5px" (click)="onLock()" *ngIf="document.status != 'LOCK' && document.number != '' && document.number!= null"></button>
</div>
<div class="left-panel section" style="max-width:25%;width:400px">
  <div id="header">
    <div><div style="margin-top:0px" class="label">{{typeDocument}}&#160;</div><div style="margin-top:0px;padding-left:20px;" class="label">{{document.number}}</div></div>
    <div><div style="margin-top:0px" class="label">Numéro Client&#160;</div><div style="margin-top:0px;padding-left:20px;" class="label">{{document.customer.number
  }}
</div></div>
    <div><div class="label">Client&#160;</div><p-autoComplete id="findCustomer" name="findCustomer"  [suggestions]="customers" (completeMethod)="searchCustomer($event)" (onSelect)="onSelectCustomer()" (onClear)="onUnselectCustomer()" (onUnselect)="onUnselectCustomer()" (onKeyUp)="onKeyupCustomer()" field="fullName" [(ngModel)]="document.customer" emptyMessage="Aucun résultat" [required]="true" class="ng-invalid" placeholder="Nom du client"></p-autoComplete></div>
    <div><div class="label">Date du devis&#160;</div><p-calendar [(ngModel)]="document.date" dateFormat="dd/mm/yy" [required]="true" placeholder="Date du devis"></p-calendar></div>
    <div><div class="label">Expire le&#160;</div><p-calendar [(ngModel)]="document.expirationDate" dateFormat="dd/mm/yy" [required]="true" placeholder="Date expiration"></p-calendar></div>
  </div>
</div>
<div class="right-panel section" style="max-width:75%;width:1200px">
  <p-tabView (onChange)="onChangeTab($event)">
    <p-tabPanel header="Détails">
      <app-child-tabpanel-detail [document]="document"></app-child-tabpanel-detail>
    </p-tabPanel>
    <p-tabPanel header="Adresse document">
      <app-child-tabpanel-address [customer]="document.customer"></app-child-tabpanel-address>
    </p-tabPanel>
    <p-tabPanel header="Aperçu document">
      <iframe [src]="urlPdf" style="width:100%; height:100%; min-height:500px"></iframe>
    </p-tabPanel>
    <p-tabPanel header="Statut" id="status">
      <div *ngFor="let status of document.statusHistory">
        <div class="label">{{status.status | documentstatus}}</div><div class="label label-large">Par {{status.updatedBy}}</div><div class="label">Le {{status.created | date : 'dd/MM/yyyy HH:mm:ss'}}</div>
      </div>
    </p-tabPanel>
    <p-tabPanel header="Historique" id="historic">

    </p-tabPanel>
    <p-tabPanel header="Workflow" id="workflow">
      <button pButton type="button" label="Envoyer" icon="pi pi-inbox" class="p-button-secondary p-button-sm" (click)="sendMail()"></button>
      <button pButton type="button" label="Duplicata" icon="pi pi-file-pdf" class="p-button-info p-button-sm"></button>
      <button pButton type="button" label="Facturer" icon="pi pi-money-bill" class="p-button-danger p-button-sm not-always"></button>
      <button pButton type="button" label="Annuler" icon="pi pi-money-bill" class="p-button-warning p-button-sm not-always"></button>
    </p-tabPanel>
  </p-tabView>
  <p-blockUI [blocked]="blocked"></p-blockUI>
</div>

<p-dialog header="Message" [(visible)]="popupDisplay" [style]="{width: '50vw'}" [baseZIndex]="10000">
  <p>
    {{popupMessage}}
  </p>
  <ng-template pTemplate="footer">
    <p-button icon="pi pi-check" (click)="popupDisplay=false" label="OK" styleClass="p-button-text"></p-button>
  </ng-template>
</p-dialog>
<p-confirmDialog [style]="{width: '50vw'}" [baseZIndex]="10000"></p-confirmDialog>
</div>
